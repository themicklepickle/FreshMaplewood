<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="static/index.css">
    <link rel="icon" href="../static/mapleleaf.png" type="image/gif" sizes="16x16">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <title>Fresh Maplewood</title>

    <style>
        body {
            animation: fadeInAnimation ease 2s;
            animation-iteration-count: 1;
            animation-fill-mode: forwards;
        }
    
        @keyframes fadeInAnimation {
            0% {
                opacity: 0;
            }
    
            100% {
                opacity: 1;
            }
        }
    </style>
</head>

<body>
    <div class="container-fluid bg-light">
        <!-- header (course | mark | updated | details) -->
        <div class="row py-3 text-white border-bottom border-dark align-items-center text-center" 
            style="background-image: linear-gradient( rgb(91, 192, 222), #46bda1); border-bottom-width: 15px;">
            <!-- details col (blank) -->
            <div class="col-4">
            </div>
            <!-- course -->
            <div class="col-20">
                <h3 class="my-0">Course</h3>
            </div>
            <!-- mark -->
            <div class="col-10">
                <a class="text-white my-0" data-target="#courseMark,#markButton" data-toggle="collapse" role="button">
                    <h3 class="my-0 mx-0">Mark</h3>
                </a>
            </div>
            <!-- updated -->
            <div class="col-10">
                <h3 class="my-0">Updated</h3>
            </div>
            <!-- sign out -->
            <div class="col-6">
                <a class="text-white my-0 "href="/signin">
                    <i class="material-icons signout">exit_to_app</i>
                </a>
            </div>
        </div>

        <!-- loop through courses -->
        {% for course in courses %}

        <!-- course row -->
        <div class="row py-3 bg-info text-white border-bottom border-light align-items-center text-center">
            <!-- details button -->
            <div class="col-4"> 
                <a data-toggle="modal" data-target="#{{ course['code'] }}details" role="button" aria-expanded="false"
                    aria-controls="{{ course['code'] }}details">
                    <i class="material-icons">info</i>
                </a>
            </div>
            <!-- name -->
            <div class="col-20">
                {% if course["name"] in aliases %}
                <h5 class="my-0 text-center">{{ aliases[course["name"]] }}</h5>
                {% else %}
                <h5 class="my-0">{{ course["name"] }}</h5>
                {% endif %}
            </div>
            <!-- mark button -->
            <div class="col-10">
                <div class="collapse" id="courseMark">
                    <a class="text-white" data-toggle="collapse" data-target="#{{ course['code'] }}marks"
                        aria-expanded="false" aria-controls="{{ course['code'] }}marks" role="button"
                        {% if not course["lastUpdated"] %}disabled{% endif %}>
                            {% if course["mark"] %}
                            <h5 class="my-2">{{ course["mark"] }}%</h5>
                            {% else %}
                            <h5 class="my-2"></h5>
                            {% endif %}
                        </a>
                </div>
                <div class="collapse show my-0" id="markButton">
                    <button class="btn btn-light text-info" type="button" data-toggle="collapse" data-target="#{{ course['code'] }}marks"
                        aria-expanded="false" aria-controls="{{ course['code'] }}marks"
                        {% if not course["lastUpdated"] %}disabled{% endif %}>Marks</button>
                </div>
            </div>
            <!-- updated -->
            <div class="col-10">
                <h5 class="my-0">{{ course["lastUpdated"] }}</h5>
            </div>
            <!-- sign out column (blank) -->
            <div class="col-6">
            </div>
        </div>

        <!-- details -->
        <div class="modal fade" id="{{ course['code'] }}details" tabindex="-1" role="dialog" 
            aria-labelledby="#{{ course['code'] }}details" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">{{ course['name'] }}</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <h5 class="my-0">Teacher: {{ course["teacher"] }}</h5>
                        <h5 class="my-0">Absent: {{ course["absent"] }}</h5>
                        <h5 class="my-0">Excused: {{ course["excused"] }}</h5>
                        <h5 class="my-0">Late: {{ course["late"] }}</h5>
                    </div>
                </div>
            </div>
        </div>

        <!-- <div class="collapse" id="{{ course['code'] }}details">
            <div class="row py-1 bg-secondary text-white border-bottom border-light align-items-center text-center">
                <div class="col">
                    <h5 class="my-0">{{ course["teacher"] }}</h5>
                </div>
                
                <div class="col-2">
                    <h5 class="my-0">Absent: {{ course["absent"] }}</h5>
                </div>
                <div class="col-2">
                    <h5 class="my-0">Excused: {{ course["excused"] }}</h5>
                </div>
                <div class="col-2">
                    <h5 class="my-0">Late: {{ course["late"] }}</h5>
                </div>
            </div>
        </div> -->


        
        <!-- marks -->
        <div class="collapse" id="{{ course['code'] }}marks">
            <table class="table">
                <thead class="bg-success text-white">
                    <tr>
                        <th scope="col" style="width: 30%;">Category/Item</th>
                        <th scope="col" style="width: 20%;">Percentage</th>
                        <th scope="col" style="width: 10%;">Mark</th>
                        <th scope="col" style="width: 10%;">Denominator</th>
                        <th scope="col" style="width: 10%;">Weight</th>
                        <th scope="col" style="width: 20%;">Date</th>
                    </tr>
                </thead>
                {% for unit in course["units"] %}
                <thead class="table-info">
                    <tr>
                        <th scope="col">{{ unit["name"] }}</th>
                        {% if unit["mark"] %}
                        <th scope="col">{{ "%.2f"|format(unit["mark"] / unit["denominator"] * 100) }}%</th>
                        <th scope="col">{{ "%.2f"|format(unit["mark"]) }}</th>
                        {% else %}
                        <th scope="col"></th>
                        <th scope="col"></th>
                        {% endif %}
                        <th scope="col">{{ unit["denominator"] }}</th>
                        <th scope="col">{{ unit["weight"] }}</th>
                        <th scope="col"></th>
                    </tr>
                </thead>
                {% if unit["has sections"] %}
                    {% for section in unit["sections"] %}
                    <thead class="table-active">
                        <tr>
                            <th scope="col">{{ section["name"] }}</th>
                            {% if section["mark"] %}
                            <th scope="col">{{ "%.2f"|format(section["mark"] / section["denominator"] * 100) }}%</th>
                            <th scope="col">{{ "%.2f"|format(section["mark"]) }}</th>
                            {% else %}
                            <th scope="col"></th>
                            <th scope="col"></th>
                            {% endif %}
                            <th scope="col">{{ section["denominator"] }}</th>
                            <th scope="col">{{ section["weight"] }}</th>
                            <th scope="col"></th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for assignment in section["assignments"] %}
                        <tr>
                            <td scope="col">{{ assignment["name"] }}</td>
                            {% if assignment["mark"] %}
                            <th scope="col">{{ "%.2f"|format(assignment["mark"] / assignment["denominator"] * 100) }}%</th>
                            {% else %}
                            <th scope="col"></th>
                            {% endif %}
                            <td scope="col">{{ assignment["mark"] }}</td>
                            <td scope="col">{{ assignment["denominator"] }}</td>
                            <td scope="col">{{ assignment["weight"] }}</td>
                            <td scope="col">{{ assignment["date"] }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                    {% endfor %}
                {% else %}
                <tbody>
                    {% for assignment in unit["assignments"] %}
                    <tr>
                        <td scope="col">{{ assignment["name"] }}</td>
                        {% if assignment["mark"] %}
                        <th scope="col">{{ "%.2f"|format(assignment["mark"] / assignment["denominator"] * 100) }}%</th>
                        {% else %}
                        <th scope="col"></th>
                        {% endif %}
                        <td scope="col">{{ assignment["mark"] }}</td>
                        <td scope="col">{{ assignment["denominator"] }}</td>
                        <td scope="col">{{ assignment["weight"] }}</td>
                        <td scope="col">{{ assignment["date"] }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
                {% endif %}
                {% endfor %}
            </table>
        </div>
        {% endfor %}
        </div>

        
    </div>
    <!-- Footer -->
    <div class="d-none d-sm-block container-fluid py-5 align-items-center text-center" style="background-image: linear-gradient(#46bda1, rgb(91, 192, 222))">
        <div class="row py-1">
            <div class="col">
                <h3 class="text-light">
                    Fresh Maplewood
                </h3>
            </div>
        </div>
        <div class="row py-2">
            <div class="col">
                <h6 class="text-light">
                    by Michael Xu
                </h6>
            </div>
        </div>
    </div>
    
    <!-- <script>
        $('#markButton').collapse("toggle")
    </script> -->
    
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
        crossorigin="anonymous"></script>
    <script src="../static/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
</body>

</html>